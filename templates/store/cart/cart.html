{% extends 'base.html' %}
{% load static %}

{% block title %}Shopping Cart{% endblock title %}

{% block content %}
	<main class="pt-5">
		<div class="container">
			<div class="row" id="cart-header" hx-get="{% url 'cart:update_details' %}" hx-trigger="load delay:1s, cartUpdatedEvent from:body">
				{% include "store/cart/_details.html" %}
			</div>
			<br>
			<div class="row g-3">
				{% if cart|length > 0 %}
					<div class="col-12">
						{% for item in cart %}
							{% with product=item.product %}
								<div id="product={{ product.id }}" class="card mb-3 border-0 product-item" data-index="{{ product.id }}"></div>
								<div class="row g-0">
									<div class="col-md-10 ps-md-3">
										<div class="card-body p-1">
											<a class="text-decoration-none text-reset" href="{{ product.get_absolute_url }}">
												<p class="card-text pb-3">
													{{ product.title }}
													{{ item.price }} X
													{{ item.qty }} =
													{{ item.total_price }}
												</p>
											</a>
											<button hx-delete="{{ product.remove_from_cart_url }}" id="delete-button-{{ product.id }}"
													hx-headers='{"X-CSRFToken": "{% csrf_token %}"}'
													hx-target="#product-{{ product.id }}" hx-swap="outerHTML">Delete
											</button>
										</div>
									</div>
								</div>
								</div>
							{% endwith %}
						{% endfor %}
					</div>
				{% endif %}
		</div>
		<br>
		<div class="row" id="cart-footer" hx-get="{% url 'cart:update_footer' %}" hx-trigger="load delay:1s, cartUpdatedEvent from:body">
			{% include 'store/cart/_footer.html' %}
		</div>
	</main>
{% endblock content %}